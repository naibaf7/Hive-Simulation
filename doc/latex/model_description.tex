\section{Description of the Model}
\subsection{Basic model: Hive simulation}
	Our model is widely based on the studies and equations of \textit{Khoury et al.} \cite{khoury13}. We used his quantitative models as described bellow and added new parameters to find out more about the bee's behaviour.\\
	Food, seasons, brood, foragers and hive bees are the cornerstone of our model. The dynamics of the hive is based on the bee's behaviour and their interaction with the environment as well as natural influences, i.e. seasons (which are separately added to Khoury's model). Food here means nectar and pollen, which is not further distinguished for simplicity reasons. After the queen laid an egg, a larvae develops inside a honeycomb cell. The equations show the proportionality of the pupation to the food income. Neglecting the complex process of reaching adulthood, we assume that larvae become adult hive bees 12 days after pupation. The mortality rate of hive bees or capped brood is negligible if there are not specific diseases implemented. $TODO$ The agents are only female bees since they are responsible for the foraging process and the maintenance and sustainability of the population. With all these information we can set up
	
	\begin{equation}\label{eq:changeBroodNumbers}
		{dB \over dt} = LS(H,f)-\phi B
	\end{equation}
	
	representing the rate of change of brood numbers. $L$ is  rate of the bee queen and $S(H,f)$ is a function of the survival rate dependent on the amount of food and  the number of hive bees. $\phi$ is the adult bee emerging factor and $B$ represents the uncapped brood. The equation gives us the survival rate of the brood. $S(H,f)$ is modelled as following:
	
	\begin{equation}\label{eq:functionHiveBeesFood}
		S(H,f)={f^2 \over f^2+b^2}{H \over H+v}
	\end{equation}
	
	The variable $v$ indicates the effect of the hive bees on the brood, whereas $b$ shows the food effect on brood survival. It decreases as food increases. As $f$ and $H$ become very large, $S(H,f)$ becomes constant. The food and hive bee number is no longer connected to each other. The first factor is a sigmoid function and shows the correlation of the food available and the capped brood. A decrease in brood can occur because of lack of food (they cannot be fed) and because adult bees consume the larvae to keep the resources in the hive and recycle the proteins (cannibalism). The second factor models the interdependency of the hive bee numbers on the survival of the brood. If there are large stores of food but no hive bees that can provide the food to the larvae, the brood survival also declines.  
	\\
	The second differential equation describes the rate at which the number of hive bees changes.	
	\begin{equation}\label{eq:changeHiveBees}
		{dH \over dt}=\phi B(t-\tau)-HR(H,F,f)
	\end{equation}
	
	$\tau$ is the ageing time and $\phi B(t-\tau)$ is the rate at which adult bees hatch out from pupation. The second term is the recruitment function and given as
		
		\begin{equation}\label{eq:recruitmentFunction}
			R(H,F,f) = \alpha_{min} + \alpha_{max}({b^2 \over b^2+f^2})-\sigma({F \over F+H})
		\end{equation}
				
	This equation models the change from a hive bee to a forager bee. $\alpha_{min}$ denotes the transition when there is enough food but not much foragers. Conversely, $\alpha_{max}$ is used for less food. As before, $b$ is the food effect on brood survival and $f$ is the amount of food. $\sigma$ is the strength of social inhibition and is dependent on the number of foragers and hive bees.\\
	The third differential equation describes correspondingly the rate at which the number of foragers changes:
	
	\begin{equation}\label{eq:changeForagers}
		{dF \over dt} = HR(H,F,f)-m F
	\end{equation}
	
	The mortality rate $mF$ indicated the rate at which the foragers $F$ die. The recruitment function is the same as above.\\	
	The last equation outlines with the rate of food change in the hive's stores. Forager bees and hive bees are treated equally because their consumption is almost the same. 
	
	\begin{equation}\label{eq:changeFoodStoreConst}
		{df \over dt} = c F - \gamma_A (F+H) - \gamma_B B
	\end{equation}
         
	where $c$ describes the average food a single forager collects per day. $\gamma$ is the consumption of adult bees ($A$) and brood ($B$). In our extended model, we implemented an actual environment simulation so that the food income changes over time (see chapter \ref{chap:advancedModel}). Equation \ref{eq:changeFoodStoreConst} is then replaced by equation \ref{eq:changeFoodStoreDyn}, which takes the daily food income instead of a fixed rate $c$ per forager.

	\subsection{Changing laying rate over seasons}
		\begin{figure}
			\centering
			\scalebox{.75}{\includegraphics{data/egg_plot.eps}}
			\caption{\textit{The laying rate of the bee queen plotted over a year. The amount of eggs is capped after 2000 eggs. }}
			\label{fig:dynLayingRate}
		\end{figure}
		
		To make the model more realistic, equation \ref{eq:changeBroodNumbers} is replaced by equation \ref{eq:changeBroodNumbersTime}. This incorporates that the bee queen does not have a constant laying rate. Instead, interpolated values based on \textit{Wisdom of the Hive}, pp. 34 \cite{seeley95} are used for the laying rate $L_t$ (Figure \ref{fig:dynLayingRate}). \textit{T.D. Seeley} denotes that the queen starts reproducing by early spring. We assumed that reproduction between April/May and October is realistic, as we obtained similar numbers of bees in summer (maxima) and winter (minima) to the empirical data of \textit{T.D. Seeley} \cite{seeley95}. The minimal laying rate of 200 eggs per day is used to compensate mortality during winter. The peak of the laying rate (2000 eggs per day) is the same as used by \textit{Khoury et al.} \cite{khoury13} and \textit{Wright} \cite{wright08}. The results are discussed in chapters \ref{chap:constantFoodConstantLaying} and \ref{chap:constantFoodDynamicLaying} with the corresponding plots in appendix \ref{chap:sim_R0_1} and \ref{chap:sim_R0_2}.
		
		\begin{equation}\label{eq:changeBroodNumbersTime}
			{dB \over dt} = L_tS(H,f)-\phi B
		\end{equation}
		
		The introduction of dynamic laying rates led to problems with the mortality rates tested by \textit{Khoury et al.} \cite{khoury13}. The colony we simulated did not survive with any daily mortality rates higher than 0.1 (10\%). There are not enough bees emerging from eggs in order to compensate the mortality rate. However, we found that the new mortality rates assumed in our simulation (0.075 or 7.5\% daily mortality) are still realistic. \textit{Henry et al.} \cite{henry12} describe mortality rates between 0.102 and 0.316 in empirical testing, which is the range in which \textit{Khoury et al.} \cite{khoury13} simulated. \textit{R. Dukas} \cite{dukas08} observed that mortality of foragers is in this range mainly because of predation. As we apply the mortality to all days, even in times and seasons without foraging (all bees stay in the hive), our simulated mortality rates are naturally lower.
	
	\subsection{Advanced model: Environment simulation}
		\label{chap:advancedModel}
		\input{data/model_overview.tex}
		As we were interested in observing the social dynamics under different food availability conditions, in contrast to the model of \textit{Khoury et al.} \cite{khoury13}, we had to implement a simulation for the environment. This advanced model introduces an environment with seasons which affect the queen's laying rate (see equation \ref{eq:changeBroodNumbersTime}), the distribution and quality of flower patches and seasonal flower growth.
		The forager bees are then simulated on the environment, searching and collecting food according to the rules in chapter \ref{chap:beeWorkingStates}. An overview of the complete model is given in Figure \ref{fig:modelOverview}.
		
		\subsubsection{Map and flower patches}
		%TODO
		
		\subsubsection{Bees' working states}
			\label{chap:beeWorkingStates}
			\input{data/working_states.tex}
			%TODO
		
		\subsubsection{Foragers' distribution across flower patches}
		\begin{equation}\label{eq:changeFoodStoreDyn}
			{df \over dt} = f_{d,t}- \gamma_A (F+H) - \gamma_B B
		\end{equation}
		Where $f_{d,t}$ denotes the amount of food the foragers collected on day $t$.
		
	\subsection{Empirical data bases}
		By analysing the different waggle dances of the forager bees, \textit{T.D. Seeley} states in \textit{Wisdom of the Hive} pp.~37ff that 95\% of the foraging process occurs in a radius of 6.0~km (maximum distance at 10.9~km, mean distance at 2.2~km and the modal distance at 1.6~km \cite{seeley95} The approximation of $(6~km\cdot2)^2 \approx 100~km^2$ should be sufficient for the simulation and comprehend all important data. In our model, we split the area up into a grid of 10~m~$\cdot$~10~m tiles of flower patches. \\
		The flower patches themselves are divided into their different blossom: spring, summer and autumn. The empirical data was taken from the \textit{Wisdom of the Hive} p.~44 (year 1982) and the following page. We merged the raw data and received a new graph for the whole year (see fig.~\ref{fig:seasonalFlowers}) The values are in hive weight change per kilogram per day. With equation \ref{eq:foodPerFlight}, we can find out the weight of food a bee can carry per flight.
		
		\begin{equation}\label{eq:foodPerFlight}
			\frac{M \frac{kg}{d}}{C}\cdot 1000 \frac{g}{kg} = Weight~per~bee~and~flower
		\end{equation}
		Where $M$ is a local certain height in the graph (Figure \ref{fig:seasonalFlowers}) and $C$ is the bee count of the hive approximated for day $t$ in \textit{T.D. Seeley's} empirical data \cite{seeley95}. Thus we can take hive weight change per day as an indicator for the flower quality and flower type present at any given day of the year. 
		
		
		\begin{figure}
			\centering
			\scalebox{0.9}{\includegraphics{data/seasonal_flowers.eps}}
			\caption{\textit{This figure shows flower blooming over a year. Well first it shows the UNnoramlized flower activity over a year. Second for the rest plz ask Fabian he did the Graph labeling all I can tell you is that it is a $1:1$ representation of the values from the Proberties\char`_Base file \ref{chap:MATLAB_Base}~$Prop.Sim.Flower.peak \cdot Prop.Sim.Flower.year\char`_activity$ }}
			\label{fig:seasonalFlowers}
		\end{figure}
	
